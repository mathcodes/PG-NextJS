"use strict";

const chalk = require("chalk");
const meow = require("meow");
const updateNotifier = require("update-notifier");
const execa = require("execa");

const help = chalk`
Usage:
  zoe [<file|glob> ...]

Options:
  -f, --fix       Automatically fix problems
  -v, --version   Show current version
  -h, --help      Show usage information
`;

const { flags, pkg, input } = meow(help, {
  flags: {
    help: {
      alias: "h",
    },
    version: {
      alias: "v",
    },
    fix: {
      alias: "f",
    },
  },
});

if (process.env.NODE_ENV === "test") {
  console.log(chalk.bold.green("In test mode"));
  console.log("Trigger a release2");
  console.log(flags, input);
}

updateNotifier({ pkg }).notify();
// Zoe x.x.x
console.log(`âœ¨ ${chalk.bold.cyan("Zoe")} ${pkg.version}`);

const args = [".", "--ext=.js,.jsx", "--format=pretty"];

if ("fix" in flags) {
  args.push("--fix");
}

execa("eslint", args, {
  preferLocal: true,
  stdio: "inherit",
});
